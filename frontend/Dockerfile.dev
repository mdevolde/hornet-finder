FROM node:20-alpine

WORKDIR /app

# Copier les fichiers de dépendances en premier pour le cache Docker
COPY package.json package-lock.json* ./

# Installer les dépendances locales, y compris Vite
RUN npm install

# Copier le reste du code (vite.config.ts, src/, etc.)
COPY . .

EXPOSE 5173
ENV HOST=0.0.0.0

# Lancer vite depuis node_modules pour compatibilité ESM
CMD ["npm", "run", "dev"]
